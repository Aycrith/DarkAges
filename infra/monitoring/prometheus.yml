# Prometheus configuration for DarkAges MMO
# WP-8-1: Production Monitoring

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: darkages-dev
    replica: '{{.ExternalURL}}'

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets: []
      # - targets: ['alertmanager:9093']  # Uncomment when alertmanager is added

# Load rules once and periodically evaluate them
rule_files:
  # - "alerts/*.yml"  # Uncomment when alert rules are added

# Scrape configurations
scrape_configs:
  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # DarkAges Zone Servers
  # Each zone server exports metrics on port 9100 + zone_id
  - job_name: 'darkages-zones'
    static_configs:
      - targets: ['host.docker.internal:9100']
        labels:
          zone: 'zone-1'
          instance: 'localhost'
    metrics_path: /metrics
    scrape_interval: 5s  # High frequency for game metrics

  # ScyllaDB metrics
  - job_name: 'scylla'
    static_configs:
      - targets: ['scylla:9180']
    metrics_path: /metrics

  # Redis metrics (if redis_exporter is added)
  - job_name: 'redis'
    static_configs:
      - targets: ['redis:6379']

  # Node exporter (if running on host)
  - job_name: 'node'
    static_configs:
      - targets: ['host.docker.internal:9100']
